var TABLET_WIDTH = 768;
var DESKTOP_WIDTH = 1300;
var SMALL_PIN = {width: 62, height: 62};
var BIG_PIN = {width: 124, height: 106};

function debounce(f, ms) {
  var timer = null;

  return function (cb) {
    var onComplete = function () {
      f.apply(this, cb);
      timer = null;
    };
    if (timer) {
      clearTimeout(timer);
    }
    timer = setTimeout(onComplete, ms);
  };
}

function initialize() {
  var viewport = document.documentElement.clientWidth || window.innerWidth;
  var mapCenter = viewport < DESKTOP_WIDTH ? {lat: 59.938882, lng: 30.32323} : {lat: 59.939065, lng: 30.319335};
  var pinCenter = viewport < TABLET_WIDTH ? {lat: 59.93871, lng: 30.32323} : {lat: 59.93871, lng: 30.32299};
  var pinSize = viewport < TABLET_WIDTH ? SMALL_PIN : BIG_PIN;

  var mapOptions = {
    zoom: 17,
    center: mapCenter
  };

  var map = new google.maps.Map(document.getElementById('map'), mapOptions);

  var image = {
    url: "img/raster/map-pin.png",
    scaledSize: pinSize
  };

  var pin = new google.maps.Marker({
    position: pinCenter,
    map: map,
    icon: image
  });
}

google.maps.event.addDomListener(window, "resize", debounce(initialize, 1000));

var TABLET_WIDTH=768,DESKTOP_WIDTH=1300,SMALL_PIN={width:62,height:62},BIG_PIN={width:124,height:106};function debounce(e,n){var i=null;return function(t){i&&clearTimeout(i),i=setTimeout(function(){e.apply(this,t),i=null},n)}}function initialize(){var e=document.documentElement.clientWidth||window.innerWidth,n=e<TABLET_WIDTH?{lat:59.93871,lng:30.32323}:{lat:59.93871,lng:30.32299},i=e<TABLET_WIDTH?SMALL_PIN:BIG_PIN,t={zoom:17,center:e<DESKTOP_WIDTH?{lat:59.938882,lng:30.32323}:{lat:59.939065,lng:30.319335}},o=new google.maps.Map(document.getElementById("map"),t),l={url:"img/raster/map-pin.png",scaledSize:i};new google.maps.Marker({position:n,map:o,icon:l})}google.maps.event.addDomListener(window,"resize",debounce(initialize,1e3));
(function () {
  var nav = document.querySelector('.page-nav');
  var toggle = nav.querySelector('.page-nav__toggle');

  nav.classList.remove('page-nav--no-js');

  toggle.addEventListener('click', function () {
    nav.classList.toggle('page-nav--opened');
  });
})();

!function(){var e=document.querySelector(".page-nav"),n=e.querySelector(".page-nav__toggle");e.classList.remove("page-nav--no-js"),n.addEventListener("click",function(){e.classList.toggle("page-nav--opened")})}();
(function () {
  var TABLET_WIDTH = 768;
  var slider = document.querySelector(".slider");
  var scale = slider.querySelector(".slider__scale");
  var grip = scale.querySelector(".slider__grip");
  var before = slider.querySelector(".slider__image--before");
  var after = slider.querySelector(".slider__image--after");
  var btnBefore = slider.querySelector(".slider__btn--before");
  var btnAfter = slider.querySelector(".slider__btn--after");
  var sliderWidth,
    scaleWidth,
    gripWidth;

  var getElemWidth = function (elem) {
    return parseInt(getComputedStyle(elem).width, 10);
  };

  btnBefore.onclick = function (evt) {
    evt.preventDefault();
    before.style.width = "100%";
    after.style.width = "0";
    grip.style.marginLeft = "0";
  };

  btnAfter.onclick = function (evt) {
    evt.preventDefault();
    before.style.width = "0";
    after.style.width = "100%";
    grip.style.marginLeft = "calc(100% - " + gripWidth + "px)";
  };

  grip.ondblclick = function () {
    before.style.width = "50%";
    after.style.width = "50%";
    grip.style.marginLeft = "calc(50% - " + gripWidth / 2 + "px)";
  };

  var getCoords = function (elem) {
    var box = elem.getBoundingClientRect();
    return box.left + pageXOffset;
  };

  var gripDownHandler = function (evtDown) {
    var gripCoords = getCoords(grip);
    var scaleCoords = getCoords(scale);
    grip.style.transition = "none";

    var shiftX = evtDown.pageX - gripCoords;

    document.onmousemove = function (evtMove) {
      var newLeft = evtMove.pageX - shiftX - scaleCoords;

      if (newLeft < 0) {
        newLeft = 0;
      }

      var rightEdge = scaleWidth - gripWidth;
      if (newLeft > rightEdge) {
        newLeft = rightEdge;
      }

      var gripValue = newLeft / rightEdge * 100;
      grip.style.marginLeft = newLeft + "px";

      before.style.width = (100 - gripValue) + "%";
      after.style.width = gripValue + "%";
    };

    document.onmouseup = function () {
      document.onmousemove = document.onmouseup = null;
      grip.style.transition = "margin-left 0.3s ease-out";
    };

    return false;
  };

  var addGripHandlers = function () {
    grip.addEventListener("mousedown", gripDownHandler);
  };

  var removeGripHandlers = function () {
    grip.removeEventListener("mousedown", gripDownHandler);
  };


  var initialize = function() {
    var viewport = document.documentElement.clientWidth || window.innerWidth;

    if (viewport >= TABLET_WIDTH) {
      addGripHandlers();
    } else {
      removeGripHandlers();
    }

    sliderWidth = getElemWidth(slider);
    scaleWidth = getElemWidth(scale);
    gripWidth = getElemWidth(grip);

    before.style.width = "";
    after.style.width = "";
    grip.style.marginLeft = "";
  };

  window.addEventListener("load", initialize);
  window.addEventListener("resize", initialize);
})();

!function(){var e,t,n=document.querySelector(".slider"),i=n.querySelector(".slider__scale"),r=i.querySelector(".slider__grip"),o=n.querySelector(".slider__image--before"),l=n.querySelector(".slider__image--after"),d=n.querySelector(".slider__btn--before"),s=n.querySelector(".slider__btn--after"),u=function(e){return parseInt(getComputedStyle(e).width,10)};d.onclick=function(e){e.preventDefault(),o.style.width="100%",l.style.width="0",r.style.marginLeft="0"},s.onclick=function(e){e.preventDefault(),o.style.width="0",l.style.width="100%",r.style.marginLeft="calc(100% - "+t+"px)"},r.ondblclick=function(){o.style.width="50%",l.style.width="50%",r.style.marginLeft="calc(50% - "+t/2+"px)"};var c=function(e){return e.getBoundingClientRect().left+pageXOffset},a=function(n){var d=c(r),s=c(i);r.style.transition="none";var u=n.pageX-d;return document.onmousemove=function(n){var i=n.pageX-u-s;i<0&&(i=0);var d=e-t;i>d&&(i=d);var c=i/d*100;r.style.marginLeft=i+"px",o.style.width=100-c+"%",l.style.width=c+"%"},document.onmouseup=function(){document.onmousemove=document.onmouseup=null,r.style.transition="margin-left 0.3s ease-out"},!1},m=function(){(document.documentElement.clientWidth||window.innerWidth)>=768?r.addEventListener("mousedown",a):r.removeEventListener("mousedown",a),u(n),e=u(i),t=u(r),o.style.width="",l.style.width="",r.style.marginLeft=""};window.addEventListener("load",m),window.addEventListener("resize",m)}();